<!DOCTYPE html>
<html ng-app="app">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.js"></script>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/css/bootstrap.css" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.13/angular.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Oswald:400,700,300' rel='stylesheet' type='text/css'>	
	<link href="css/style.css" rel="stylesheet">
	<meta name="apple-mobile-web-app-capable" content="yes">

	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/0.12.1/ui-bootstrap-tpls.js"></script>

	<script src="https://cdn.firebase.com/js/client/2.2.2/firebase.js"></script>
	<script src="https://cdn.firebase.com/libs/angularfire/1.0.0/angularfire.min.js"></script>
</head>

<body ontouchstart="" ng-controller="controller">
	<div class="headerplaceholder" ng-include="'header.html'"></div>
	<div class="footerplaceholder" ng-include="'footer.html'"></div>

	<div class="container">	
		<h4 class="full title">{{event.name}} <small>{{event.description}}</small></h4>

		<style>
			.dashboard .btn {
				height: 100px;
				font-size: 20px;
				border: 0px solid silver;
				border-radius: 5px;
				background-color: #eee;
				position:relative;
				padding:10px;
				margin:10px;
			}

			.dashboard .icon {
				position:absolute;
				left: 5px;
				opacity: 0.3;
			}

			.dashboard .col-xs-10 {
				 width:332px;
			}

			.dashboard .main {
				line-height:75px;
			}

			.dashboard .badge {
				vertical-align: super;
			}

			.dashboard .sub {
				float:right;
				width:30%;
				font-size: 12px;
			}o

			.dashboard .sub .badge {
				font-size: 8px;
				font-weight: normal;
			}

			.dashboard .new {
				border: 5px dotted silver;
			}

			div.choice {
				line-height: 1.6em;
				text-indent: 10px;
				background-color: #eee;
			}
		</style>

		<div class="row dashboard">
		  <div
		  		class="col-xs-6" >
		  	<span class="main"> 
		  		<h4 style="margin-bottom:5px"> Participants <br></h4>
		  		<div ng-repeat="u in event.users" class="choice">
			  		<small ng-bind="users.$getRecord(u).name"></small><Br>
		  		</div>
		  	</span>
		  </div>

		  <div 	ng-repeat="t in event.topics" 
		  		class="col-xs-6" >
		  	<span class="main"> 
		  		<h4 style="margin-bottom:5px"> {{topics.$getRecord(t).name}} <br> <small> {{topics.$getRecord(t).description}} </small></h4>
		  		<div ng-repeat="c in topics.$getRecord(t).choices" class="choice">
			  		<small ng-bind="c"></small><Br>
		  		</div>
		  	</span>
		  </div>
		</div>

		<div style="clear:both"></div>

		<a class="btn btn-block btn-success" href="#" ng-click="test()" style="margin-top:10px; margin-left:-5px"> Chat </a>

		<div class="bottomplaceholder"></div>
	</div>

	<script>
		var app = angular
					.module("app", ["firebase", 'ui.bootstrap'])
					.controller("controller", 
						function($scope, $firebaseObject, $firebaseArray, $window) {
						    $scope.topics = $firebaseArray(new Firebase("https://eventshk.firebaseio.com/topic"));
						    $scope.users = $firebaseArray(new Firebase("https://eventshk.firebaseio.com/user"));

							$scope.goto = function(id) {
	  							if (angular.defined(linkEvent)) {
		  							linkEvent("eventsummary.html?id=" + id);
	  							} else {
		  							$window.location.href = "eventsummary.html?id=" + id;
	  							}
	  						};	  						

	  						$scope.getParam = function(name) {
							    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
							    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
							    results = regex.exec($window.location.search);
							    return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
							};

						    var obj = $firebaseObject(new Firebase("https://eventshk.firebaseio.com/event/" + $scope.getParam('id')));
						    
						     // to take an action after the data loads, use the $loaded() promise
						     obj.$loaded().then(function() {
						        console.log("loaded record:", obj.$id);
						     });

						     // For three-way data bindings, bind it to the scope instead
						     obj.$bindTo($scope, "event"); 


						     $scope.test = function() {
						     	console.log('test');
						     };
						}
					);
	</script>
</body>
</html>

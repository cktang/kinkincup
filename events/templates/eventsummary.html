
<div class="ui header">
	<div ng-click="goto('history/' + event.$id)" class="ui right floated tiny button"> <i class="ui icon history"></i> History </div>
	<div ng-click="goto('chat/' + event.$id + '/type/event')" class="ui right floated tiny button"> <i class="ui icon wechat"></i> Chat </div>
	{{event.name}} 
	<div class="ui sub header">{{event.description}}</div>
	<div class="ui divider"></div>
</div>

<style>
	div.topic {
		margin-bottom: 10px;
	}

	div.choice .badge {
		font-weight: normal !important;
	}

	div.choice.chosen {
		font-weight: bold !important;
		background-color: #ccc;
	}

	div.choice {
		padding: 0em !important;
	}
	
	#participants .ui.grid {
		margin: inherit;
	}
	
	#participants .ui.column {
		background-color: white;
	}
</style>

	<!-- Modal -->
	<div class="ui modal fade" id="modal" ng-init="decisions = ['yes', 'maybe', 'no']">
	  <div class="ui header"> Participants </div>

		<div ng-repeat="d in decisions">
		  <div class="ui attached segment" style="border:0px" 
		  		ng-class="{
				  'inverted green': _(event.users).findWhere({ id: local.user.$id }).decision == 'yes' && d == 'yes',
				  'inverted yellow': _(event.users).findWhere({ id: local.user.$id }).decision == 'maybe' && d == 'maybe',
				  'inverted red': _(event.users).findWhere({ id: local.user.$id }).decision == 'no' && d == 'no'
				}"
		  		ng-click=" logParticipate(d); _(event.users).findWhere({ id: local.user.$id }).decision = d;"> 
			  <span ng-show="_(event.users).findWhere({ id: local.user.$id }).decision == d"><i class="ui checkmark icon"></i></span>
			  {{ d }} 
		  </div>
		</div>

	      <div class="ui segment">
	        <button type="button" class="ui blue button close">OK</button>
	      </div>
	    </div>
	  </div>
	</div>

	<div class="ui sticky topic link" id="participants" ng-click="decision()">
		<h4 class="ui header">
			<span class="ui right floated sub header"> 
				<span class="ui label"  ng-class="{
					'green': _(event.users).findWhere({ id: local.user.$id }).decision == 'yes',
					'yellow': _(event.users).findWhere({ id: local.user.$id }).decision == 'maybe',
					'red': _(event.users).findWhere({ id: local.user.$id }).decision == 'no'
				}">
					<i class="ui icon" ng-class="{
						'checkmark': _(event.users).findWhere({ id: local.user.$id }).decision == 'yes',
						'help': _(event.users).findWhere({ id: local.user.$id }).decision == 'maybe',
						'remove': _(event.users).findWhere({ id: local.user.$id }).decision == 'no'
					}"></i> 
					{{ _(event.users).findWhere({ id: local.user.$id }).decision }}
				</span>
			</span>
			Participants 
		</h4>
		
		<div class="ui three column grid" style="clear:both">
			<div class="ui column">Going</div>
			<div class="ui column">Maybe</div>
			<div class="ui column">Invited</div>	
				
			<div class="ui column">
				<div ng-repeat="u in event.users" ng-if="u.decision=='yes'">
					<span  ng-bind="users.$getRecord(u.id).name"></span>
				</div>
				<div ng-if="_(event.users).filter({ decision: 'yes' }).length == 0"> / </div>
			</div>
			<div class="ui column">
				<div ng-repeat="u in event.users" ng-if="u.decision=='maybe'">
					<span  ng-bind="users.$getRecord(u.id).name"></span>
				</div>
				<div ng-if="_(event.users).filter({ decision: 'maybe' }).length == 0"> / </div>
			</div>
			<div class="ui column">
				<div ng-repeat="u in event.users" ng-if="u.decision=='no'">
					<span  ng-bind="users.$getRecord(u.id).name"></span>
				</div>
				<div ng-if="_(event.users).filter({ decision: 'no' }).length == 0"> / </div>
			</div>
		</div>
	</div>

  	<div ng-repeat="t in event.topics" 
  		class="ui link topic" 
  		ng-click="goto('eventTopic/' + t)">

  		<h4 class="ui header"> 
			<span class="ui right floated sub header">
				<span class="ui label" ng-class="{
						'green': topics.$getRecord(t).votes[local.user.$id],
						'yellow': !topics.$getRecord(t).votes[local.user.$id]
					}">
					<i class="ui icon" ng-class="{
						'checkmark': topics.$getRecord(t).votes[local.user.$id],
						'help': !topics.$getRecord(t).votes[local.user.$id]
					}"></i>
					{{topics.$getRecord(t).votes[local.user.$id]}}
				</span> 
			</span>
			
			{{topics.$getRecord(t).name}} <br> <small> {{topics.$getRecord(t).description}} </small>
		</h4>
  		<div 	ng-repeat="c in topics.$getRecord(t).choices" 
  				class="ui choice attached segment"
				ng-class="{ 'green inverted': getVote(t, c) ==  maxVotes(t) }">
			<span class="ui horizontal circular label" ng-bind="getVote(t, c)"></span>
	  		<span ng-bind="c"></span>
  		</div>
	</div>

<div style="clear:both"></div>


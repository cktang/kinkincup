

<style>
	.chats .chat {
		clear:both;
		margin: 10px 0px;
	}

	.chats .sent {
		float:right;
	}

	.dim {
		opacity: 0.8;
	}
</style>

<div class="chats">
	<div
			ng-repeat="h in history | orderBy:'ts' | reverse "
			ng-if="!(h.topic && h.topic!=r.id)"
			style="margin-top:5px; clear:both">

		<div class="ui small image label"
				ng-class="{
					'green': _(['vote', 'add choice', 'finalize', 'topic added', 'add choice', 'add event']).contains(h.action) || (h.action=='participate' && h.content=='yes'),
					'red': _(['unvote', 'un-finalize', 'remove choice', 'topic removed', 'event removed']).contains(h.action) || ( h.action=='participate' && h.content=='no'),
					'yellow': h.action=='participate' && h.content=='maybe',
					'fluid basic dim': h.action != 'chat',
					'teal': h.action == 'chat',
				}"
		>
			<i class="ui icon"
				ng-class="{
					'checkmark': _(['vote', 'unvote']).contains(h.action),
					'grid layout': _(['event added', 'event removed']).contains(h.action),
					'list layout': _(['topic added', 'topic removed']).contains(h.action),
					'block layout': _(['add choice', 'remove choice']).contains(h.action),
					'comment': _(['chat']).contains(h.action),
					'announcement': _(['participate']).contains(h.action),
					'pin': _(['finalize', 'un-finalize']).contains(h.action)
				}"/>

				<span ng-if="h.action != 'chat'" style="float:right">{{h.ts}}</span>

				{{users.$getRecord(h.user).name.split(' ')[0]}}:
				<span style="margin-left:0.2em">{{ h.content }}</span>
		</div>
	</div>

	<div style="clear:both; height:100px;">&nbsp;</div>
</div>

<div style="position:fixed; bottom:0px; width:100%; margin-left:-0.5em">
	<input placeholder="chat..." class="link" style="padding:10px; width:100%" ng-model="newText"/>
	<div class="ui fluid button" ng-click="newChat(newText); newText = ''"> Chat </div>
</div>

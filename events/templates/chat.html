

<style>
	.dim {
		opacity: 1;
		background-color: #eee !important;
	}

	.ui.label {
		margin-left: 0px !important;
		border-radius: 0px;
	}

	.ui.name.label {
		margin-top:10px;
		border-bottom: 0px;
	}
</style>

<div class="chats">
	<!--  | filter:matchTopic(h, r) -->
	<div ng-repeat="h in subhistory">

		<div class="ui large grey name fluid label"
			ng-if="h.user != subhistory[$index-1].user">
			{{ users.$getRecord(h.user).name }}
			<span class="detail" style="float:right">{{h.ts}}</span>
		</div>

		<div class="ui large fluid label"
				ng-class="{
					'green': _(['vote', 'add choice', 'finalize', 'topic added', 'add choice', 'add event']).contains(h.action) || (h.action=='participate' && h.content=='yes'),
					'red': _(['unvote', 'un-finalize', 'remove choice', 'topic removed', 'event removed']).contains(h.action) || ( h.action=='participate' && h.content=='no'),
					'yellow': h.action=='participate' && h.content=='maybe',
					'fluid basic dim': h.action != 'chat',
					'teal': h.action == 'chat',
				}">

			<i class="ui icon"
				ng-class="{
					'checkmark': _(['vote', 'unvote']).contains(h.action),
					'grid layout': _(['event added', 'event removed']).contains(h.action),
					'list layout': _(['topic added', 'topic removed']).contains(h.action),
					'block layout': _(['add choice', 'remove choice']).contains(h.action),
					'comment': _(['chat']).contains(h.action),
					'announcement': _(['participate']).contains(h.action),
					'pin': _(['finalize', 'un-finalize']).contains(h.action)
				}"/>

			<span>{{ h.content }}</span>
		</div>
	</div>

	<div style="clear:both; height:100px;">&nbsp;</div>
</div>

<div style="position:fixed; bottom:0px; width:100%; margin-left:-0.5em">
	<input placeholder="chat..." class="link" style="padding:10px; width:100%" ng-model="newText"/>
	<div class="ui fluid button" ng-click="newChat(newText); newText = ''"> Chat </div>
</div>
